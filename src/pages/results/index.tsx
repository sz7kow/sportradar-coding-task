import {GetStaticProps} from 'next';
import Head from 'next/head';
import {Fragment} from 'react';

import {SeasonSchedulesResultsTable} from '@/components/season-schedules-results-table';
import {SeasonSchedule} from '@/types/vendors/sport-radar/season-schedule';
import {SportEventMatchStatusEnum} from '@/types/vendors/sport-radar/sport-event-match-status-enum';
import {getSeasonSchedule} from '@/services/sport-radar-service';

const SEASON_ID = 'sr:season:77453';

interface StaticProps {
  seasonSchedule: SeasonSchedule[];
}

const Page: React.FC<StaticProps> = ({seasonSchedule}) => (
  <Fragment>
    <Head>
      <title>Results | Sport Radar Coding Task</title>
      <meta content="Generated by create next app" name="description" />
      <link href="/avatar-sz7kow.png" rel="icon" />
    </Head>
    <main>
      <div className="container my-12 mx-auto p-4 xl:max-w-screen-lg">
        <h1 className="mb-8 text-4xl font-extrabold dark:text-white">Results</h1>
        <SeasonSchedulesResultsTable schedules={seasonSchedule} />
      </div>
    </main>
  </Fragment>
);

export const getStaticProps: GetStaticProps<StaticProps> = async () => {
  const seasonSchedule = await getSeasonSchedule(SEASON_ID);

  return {
    props: {
      seasonSchedule: seasonSchedule
        .filter(({sport_event_status}) => sport_event_status.match_status === SportEventMatchStatusEnum.ENDED)
        .reverse(),
    },
  };
};

export default Page;
